---
tags:
  - 학습정리
  - SLiPP_25차_스터디
  - 시스템_설계
  - 책_가상_면접_사례로_배우는_대규모_시스템_설계_기초
  - 책_System_Design_Interview
---
> [!note] 안정 해시란
> 수평적 규모 확장성 달성을 위해 요청 또는 데이터를 서버에 균등하게 나눌 때 사용하는 기술

# 안정 해시가 해결하려는 문제

> [!summary] 요약
> 서버의 추가/삭제 시 serverIndex 가 변하면서 서버에 부하가 균등하게 나누어지지 않는다.

 - 서버에 부하를 균등하게 나누는 보편적인 방법
	 - 아래 해시 함수를 사용하여 캐시 테이블을 만들어 사용한다.
	 - `serverIndex = hash(key) % N (N은 서버의 개수)`

![[System Design Interview - 표 5-1.png|300]]
![[System Design Interview - 그림 5-1.png|300]]

- 이 수식은 N 값에 크게 의존하고 있기 때문에 N 의 숫자가 변하면 serverIndex 값도 변한다.
	- 만약 서버 하나가 장애가 나서 내려간다면 serverIndex 값도 갑작스럽게 변할 것이다.
- 만약 이 해시 함수로 캐시 서버를 선택한다면, 특정 서버가 죽었을 경우 대부분의 캐시 클라이언트가 데이터가 없는 잘못된 서버에 접속하게 될 것이다.
	- 물론 결과는 대규모 캐시 미스로 이어진다.

![[System Design Interview - 표 5-2.png|300]]
![[System Design Interview - 그림 5-2.png|300]]

# 안정 해시

> [!note] 안정 해시란
> 해시 테이블 크기가 조정될 때 평균적으로 오직 k/n 개의 키만 재배치하는 해시 기술
> - k 는 key 의 개수
> - n 은 slot 의 개수

- 안정 해시와 달리 대부분의 전통적 해시 테이블은 슬롯의 수가 바뀌면 거의 대부분의 키를 재배치한다.








1. Consistent hashing : https://en.wikipedia.org/wiki/Consistent_hashing
2. Consistent Hashing : https://tom-e-white.com/2007/11/consistent-hashing.html
3. Dynamo: Amazon's Highly Available Key-value Store : https://dl.acm.org/doi/10.1145/1294261.1294281
4. Cassandra - A Decentralized Structured Storage System : https://www.cs.cornell.edu/Projects/ladis2009/papers/lakshman-ladis2009.pdf
5. How Discord Scaled Elixir to 5,000,000 Concurrent Users : https://discord.com/blog/how-discord-scaled-elixir-to-5-000-000-concurrent-users
6. CS168: The Modern Algorithmic Toolbox Lecture #1 : Introduction and Consistent Hashing : http://theory.stanford.edu/~tim/s16/l/l1.pdf
7. Maglev: A Fast and Reliable Software Network Load Balancer : https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/44824.pdf



