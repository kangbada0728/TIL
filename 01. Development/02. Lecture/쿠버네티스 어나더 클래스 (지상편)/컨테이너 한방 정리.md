---
tags:
  - 학습정리
  - 온라인_강의
  - 인프런
  - 강사_일프로
  - Kubernetes
  - Container
  - Linux
  - DevOps
---
# Linux OS, Container, Container Orchestration

![[쿠버네티스 어나더 클래스 (지상편) - Sprint1 - 섹션 1 - 그림 1.png]]

## Linux OS

![[쿠버네티스 어나더 클래스 (지상편) - Sprint1 - 섹션 1 - 그림 2.png]]

- 최초의 OS 로 UNIX 가 있었다.
- 아직도 기업에서 쓰고 있긴 하지만, 유료라서 금방 잊혀졌다.

- Linux 가 새로 나왔다.
- UNIX 와 달리 무료라서, 이를 기반으로 많은 배포판들이 만들어졌고, 만들어지고 있다.

- 이 중에서 가장 중요한 배포판은 두가지 이다.
	- debian
	- Red Hat
- debian linux 는 커뮤니티용이기 때문에 무료
- redhat linux 는 redhat 이라는 기업에서 만들었고 유료

- debian 계열의 대표 배포판은 ubuntu 가 있다.
- debian 에 비해 사용자 편의 기능이 더 많다.
- linux 에서는 최초로 Windows 처럼 UI 를 제공했다.

- IBM 인수 전 redhat 에서 linux 배포판이 만들어지는 순서
	1. fedora linux 
		- 새로운 기능을 개발하는 배포판. 무료
	2. Red Hat Enterprise Linux (RHEL, 렐)
		- 새로운 기능이 안정화 되면 이름을 위와 같이 바꿔서 릴리즈
		- 기업들이 이걸 설치하면 유지보수 비용을 내야함. 유료
	3. CentOS
		- RHEL 을 복사해서 만
		- RHEL 과 똑같이 안정화 버전이지만 무료
		- 그래서 유지보수를 직접 할 여력이 되는 기업이 쓴다.
		- 개발비용을 낮추기 위해 개발환경까지는 CentOS 를 쓰고, 운영환경만 RHEL 을 쓰기도 한다.

- 이렇게 기업에서는 redhat 계열을 많이 쓰고, 개인 학습용이나 클라우드에서는 ubuntu 를 많이 쓴다.

- 하지만 이제 CentOS8 은 2021년 지원 종료, CentOS7 은 2024년 지원 종료된다.
- 이유
	1. 시장 점유율이 ubuntu 가 압도적
		- ubuntu 47%
		- CentOS 19%
		- debian 17%
		- RHEL 2% (기업 배포판 1위)
	2. IBM 이 redhat 인수 후 전략 변경
		- CentOS 의 점유율을 RHEL 로 당기려 함

- IBM 인수 후 redhat 에서 linux 배포판이 만들어지는 순서
	1. fedora linux
		- 새로운 기능 개발하는 배포판. 무료
	2. Centos Stream
		- 새로 개발된 기능들을 테스트하는 배포판. 무료
		- 이 배포판에서는 바이너리 호환성 보장이 안될 수 있다고 말함
	3. Red Hat Enterprise Linux (RHEL, 렐)
		- 새로운 기능이 안정하된 배포판. 유료

- 따라서 기존에 CentOS 를 쓰던 기업들에게는 4가지 선택지가 있다.
	1. RHEL 로 넘어간다.
	2. CentOS 를 기술 지원해주는 기업의 도움을 받으며 그대로 CentOS 를 쓴다.
	3. Ubuntu 와 같은 타 OS 로 마이그레이션 스크립트를 이용하여 넘어간다.
	4. RHEL 를 복제하여 만드는 무료 배포판으로 넘어간다.
		- 기존 CentOS 와 같이 무료 배포판을 만드는 프로젝트가 있다.
		-  ex) rocky linux, alma linux 

- 여기서는 4번을 선택해 rocky linux 로 실습을 한다.
	- centOS 는 강사가 가장 잘쓰는 리눅스 배포판
	- 따라서 가장 잘 쓸 수 있는 배포판을 이용하여 강의를 한다.
	- rocky linux 를 선택한 이유는 훨씬 많이 사용되기 때문이다.
		- [Google Trend](https://trends.google.com/trends/explore?date=today%205-y&q=rocky%20linux,alma%20linux&hl=en)
		- Github Stars 와 forks 개수
	
## Container

![[쿠버네티스 어나더 클래스 (지상편) - Sprint1 - 섹션 1 - 그림 3.png]]

- 리눅스는 발전하면서 많은 코어 기술을 개발했다.
- 그중 하나는 격리 기술이다.
	- chroot : 유저, 파일, 네트워크 격리
	- cgroup : App 마다 cpu, memory 를 할당
	- namespace : 프로세스를 격리시켜주는 기술
- 이런 기술들이 쌓이며 각각의 App 을 독립적인 환경에서 실행시킬 수 있게 되었다.

- 이런 기술들을 집약하여 최초의 컨테이너인 LXC(Linux Container)가 만들어졌다.
- 그리고 이 기술을 기반으로 Docker 가 만들어졌다.
	- LXC 에 비해 쓰기 쉽다는 것이 장점

- Docker 가 나온 후 rkt 라는 보안이 강화된 컨테이너가 만들어졌다.
- 처음에 Docker 는 root 권한으로 설치 및 실행해야 했는데 그걸 보완하였었다.
- 하지만 현재는 rootless 설치모드가 생겨서 보안이 강화되었다.

- (rkt 의 태생을 보면) linux 의 여러 배포판 중에 컨테이너 전용 linux 인 Core OS 가 있고 rkt 는 이 OS 에 대한 대표 런타임이었다.
- 그런데 이 OS 가 redhat 으로 인수되면서 fedora coreOS 로 이름이 바뀌었다.
- 그런데 redhat 이 밀고 있는 컨테이너가 cri-o(크라이오)기 때문에 rkt 의 입지가 점점 줄어들고 있다.

## Container Orchestration

### Container Orchestration 이 가지는 장점

#### Container 만으로 배포하는 과정

![[쿠버네티스 어나더 클래스 (지상편) - Sprint1 - 섹션 1 - 그림 4.png]]

- 위 과정을 사용자가 차레대로 전부 해야한다.

#### Container Orchestration 으로 배포하는 과정

![[쿠버네티스 어나더 클래스 (지상편) - Sprint1 - 섹션 1 - 그림 5.png]]

- 사용자는 단 한번 지시만 하면 된다.

### Container Orchestration 의 히스토리

- Docker 가 나온 이후 kubernetes 를 비롯한 다양한 Container Orchestration 이 쏟아져나왔다.
- 이 제품들 간에 개념, 용어, 기술이 서로 다 다르다.
- 하지만 이제 쿠버네티스만 알면 된다.
	- [사용도가 압도적이기 때문](https://trends.google.com/trends/explore?date=today%205-y&q=%2Fg%2F11b7lxp79d,docker%20swarm,hashicorp%20nomad,%2Fm%2F012n8tpr&hl=en)

![[쿠버네티스 어나더 클래스 (지상편) - Sprint1 - 섹션 1 - 그림 6.png|]]

- Container Orchestration 은 쿠버네티스가 표준으로 되가고 있고, 이제 Container 간의 싸움이 시작된다.
- 초반에는 docker 가 우세했다.
	- 보안이 약하다는 것은 시간이 충분히 지나면 보완될 것이라는 기대가 있었고 실제로 보완이 되었었으니까.
- 하지만 k8s 에서 docker 가 빠진다는 이야기가 계속 돌며 docker 의 위세가 조금씩 꺾이기 시작하였다.
- 이유는 docker 가 쿠버네티스 인터페이스와 잘 맞지 않아서 그렇다.

- 처음에는 docker 처럼 사용자들이 쓰기 편한 컨테이너가 주목되었다.
	- 그래서 docker 를 메인으로 쿠버네티스가 만들어졌다.
- 그런데 이제 점점 컨테이너와 컨테이너 오케스트레이션이 함께 움직이며 컨테이너를 직접 다룰 일이 점점 줄어들었다.
- 왜냐하면 kubernetes 가 컨테이너 런타임을 알아서 조작하기 때문이다.
- 그래서 이제 컨테이너는 k8s 와 인터페이스가 잘 맞는지가 중요해졌다.

- 참고로 docker 가 mirantis 라는 회사에 인수가 된 이후부터 쿠버네티스 인터페이스에 잘 맞추려 하고 있기 때문에 쿠버네티스에서 docker 가 빠지지는 않게 된다.

![[쿠버네티스 어나더 클래스 (지상편) - Sprint1 - 섹션 1 - 그림 7.png]]

- 그 이후에 나온 컨테이너 런타임이 containerd 와 cri-o 이다.

- containerd 는 docker 에 컨테이너를 만들어주는 기능이 분리된 것이다.
	- docker 에는 컨테이너 기능뿐만 아니라 많은 기능이 담겨있다.
	- 그 엔진에서 containerd 프로젝트만 분리되어 나온 것이다. 
- cri-o 는 redhat 에서 만든 컨테이너 런타임이다.

- 두 컨테이너 런타임은 모두 CNCF 에 기부되었다.
- CNCF 는 클라우드 분야의 표준을 관장하는 곳이다.
- 여기에서 관리하는 프로젝트들은 기술 성숙도에 따라 Incubating project, Graduated project 로 불린다.
- Graduated project 는 충분히 기술이 성숙되었을 때 주어진다.
	- 따라서 앞으로 쿨라우드 기술을 고를 때 CNCF 를 졸업했다고 하면 그냥 믿고 쓰면 된다.
- containerd 는 이미 Graduated project
- cri-o 는 아직 Incubating project 이지만 곧 Graduated project 가 될 예정이다.

![[쿠버네티스 어나더 클래스 (지상편) - Sprint1 - 섹션 1 - 그림 8.png]]

- 쿠버네티스도 CNCF 에 기부되었고 가장 첫번째로 졸업한(Graduated) 프로젝트이다.
- 그리고 기업들은 쿠버네티스를 이용하여 자신의 제품들을 만들기 시작하였다.
	- OPENSHIFT, RANcHER, VMware Tanzu 등
- 이는 기업 관리형이라 하여, 기업이 쿠버네티스를 관리하는데 좀 더 편한 기능들을 제공해주는 제품이다.
	- 왜 이런제품이 있느냐면, 쿠버네티스는 알면 알수록 해야할 것이 많다. 그리고 작은 기업에서는 이를 전부 다루기 힘들기 때문이다.
	- 이런 제품을 설치하면 쿠버네티스 외에 모니터링, 로깅, 배포 툴까지 한 패키지로 설치해준다.
	- 문제가 생기면 기술지원도 해주기 때문에 작은 기업에서는 쓸만하다.
- 이런 제품들은 기업에서 자체 서버실에 프라이빗하게 쿠버네티스를 주로 쓰고 싶을 때 사용한다.
- 그렇지 않고, 퍼블릭으로 쿠버네티스를 쓰고 싶으면 클라우드 서비스로 쿠버네티스를 사용한다.

# Container Runtime

![[쿠버네티스 어나더 클래스 (지상편) - Sprint1 - 섹션 1 - 그림 9.png]]






